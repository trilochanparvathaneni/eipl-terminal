endpoint,method,CLIENT,TRANSPORTER,SECURITY,HSE_OFFICER,SURVEYOR,AUDITOR,TERMINAL_ADMIN,SUPER_ADMIN,context_scope
/api/bookings,GET,ALLOW,ALLOW,DENY,DENY,DENY,DENY,ALLOW,ALLOW,"client:self | transporter:self | admin:own_terminal | super_admin:all"
/api/bookings,POST,ALLOW,DENY,DENY,DENY,DENY,DENY,ALLOW,ALLOW,"client:self | admin:own_terminal | super_admin:all"
/api/bookings/stats,GET,ALLOW,ALLOW,DENY,DENY,DENY,DENY,ALLOW,ALLOW,"same as bookings GET"
/api/bookings/:id,GET,ALLOW,ALLOW,DENY,DENY,DENY,DENY,ALLOW,ALLOW,"record ownership + terminal guard"
/api/bookings/:id,PATCH,ALLOW,DENY,DENY,DENY,DENY,DENY,ALLOW,ALLOW,"client own booking; admin own terminal"
/api/bookings/:id/schedule,POST,DENY,DENY,DENY,DENY,DENY,DENY,ALLOW,ALLOW,"own terminal + slot capacity enforced"
/api/bookings/:id/assign-arm,POST,DENY,DENY,DENY,DENY,DENY,DENY,ALLOW,ALLOW,"permission controller:assign_arm + contextual checks"
/api/truck-trips,GET,ALLOW,ALLOW,ALLOW,ALLOW,ALLOW,ALLOW,ALLOW,ALLOW,"client:self | transporter:self | non-super-admin:own_terminal"
/api/truck-trips,POST,DENY,ALLOW,DENY,DENY,DENY,DENY,ALLOW,ALLOW,"transporter own booking; admin own terminal"
/api/truck-trips/:id/qr,GET,ALLOW,ALLOW,ALLOW,ALLOW,ALLOW,ALLOW,ALLOW,ALLOW,"client:self | transporter:self | admin/security own_terminal"
/api/gate/today,GET,DENY,DENY,ALLOW,DENY,DENY,DENY,ALLOW,ALLOW,"security/admin own_terminal"
/api/gate/scan,POST,DENY,DENY,ALLOW,DENY,DENY,DENY,ALLOW,ALLOW,"security/admin own_terminal"
/api/gate/check-in,POST,DENY,DENY,ALLOW,DENY,DENY,DENY,DENY,DENY,"security own_terminal"
/api/gate/check-out,POST,DENY,DENY,ALLOW,DENY,DENY,DENY,DENY,DENY,"security own_terminal"
/api/incidents,GET,DENY,DENY,ALLOW,ALLOW,ALLOW,ALLOW,ALLOW,ALLOW,"non-super-admin own_terminal"
/api/incidents,POST,DENY,DENY,ALLOW,ALLOW,DENY,DENY,ALLOW,ALLOW,"non-super-admin own_terminal"
/api/incidents/:id/close,POST,DENY,DENY,DENY,ALLOW,DENY,DENY,ALLOW,ALLOW,"non-super-admin own_terminal"
/api/safety/checklists,GET,DENY,DENY,ALLOW,ALLOW,ALLOW,ALLOW,ALLOW,ALLOW,"non-super-admin own_terminal"
/api/safety/checklists,POST,DENY,DENY,DENY,ALLOW,DENY,DENY,DENY,ALLOW,"own_terminal"
/api/safety/stop-work,GET,DENY,DENY,ALLOW,ALLOW,ALLOW,ALLOW,ALLOW,ALLOW,"non-super-admin own_terminal"
/api/safety/stop-work,POST,DENY,DENY,DENY,ALLOW,DENY,DENY,DENY,ALLOW,"own_terminal"
/api/safety/stop-work/:id/resolve,POST,DENY,DENY,DENY,ALLOW,DENY,DENY,DENY,ALLOW,"own_terminal"
/api/reports/bookings,GET,DENY,DENY,DENY,ALLOW,ALLOW,ALLOW,ALLOW,ALLOW,"non-super-admin own_terminal"
/api/reports/movements,GET,DENY,DENY,ALLOW,ALLOW,ALLOW,ALLOW,ALLOW,ALLOW,"non-super-admin own_terminal"
/api/reports/bay-utilization,GET,DENY,DENY,DENY,DENY,ALLOW,ALLOW,ALLOW,ALLOW,"non-super-admin own_terminal"
/api/reports/safety,GET,DENY,DENY,DENY,ALLOW,DENY,ALLOW,ALLOW,ALLOW,"non-super-admin own_terminal"
/api/lookup/clients,GET,DENY,DENY,DENY,DENY,DENY,DENY,ALLOW,ALLOW,"terminal admin own_terminal relevant clients"
/api/lookup/transporters,GET,ALLOW,ALLOW,ALLOW,ALLOW,ALLOW,ALLOW,ALLOW,ALLOW,"non-super-admin limited to own terminal-linked transporters"
/api/lookup/products,GET,ALLOW,ALLOW,ALLOW,ALLOW,ALLOW,ALLOW,ALLOW,ALLOW,"client:self inventory products; others terminal-scoped products"
/api/lookup/terminals,GET,ALLOW,ALLOW,ALLOW,ALLOW,ALLOW,ALLOW,ALLOW,ALLOW,"non-super-admin sees own terminal only"
/api/lookup/timeslots,GET,ALLOW,ALLOW,ALLOW,ALLOW,ALLOW,ALLOW,ALLOW,ALLOW,"non-super-admin must request own terminalId"
/api/lookup/bays,GET,ALLOW,ALLOW,ALLOW,ALLOW,ALLOW,ALLOW,ALLOW,ALLOW,"non-super-admin limited to own terminal bays"
/api/notifications,GET,ALLOW,ALLOW,ALLOW,ALLOW,ALLOW,ALLOW,ALLOW,ALLOW,"user:self only"
/api/notifications,PATCH,ALLOW,ALLOW,ALLOW,ALLOW,ALLOW,ALLOW,ALLOW,ALLOW,"user:self only"
/api/audit-logs,GET,DENY,DENY,DENY,DENY,DENY,ALLOW,DENY,ALLOW,"auditor scoped to own terminal actors; super_admin all"
/api/documents,GET,ALLOW,DENY,DENY,DENY,ALLOW,ALLOW,ALLOW,ALLOW,"permission document:read + booking/client checks"
/api/documents,POST,ALLOW,ALLOW,DENY,DENY,DENY,DENY,ALLOW,ALLOW,"permission document:upload + ownership checks"
/api/documents/:id/verify,POST,DENY,DENY,DENY,DENY,ALLOW,DENY,ALLOW,ALLOW,"permission document:verify"
/api/documents/:id/reject,POST,DENY,DENY,DENY,DENY,ALLOW,DENY,ALLOW,ALLOW,"permission document:reject"
/api/loading-arms,GET,DENY,DENY,DENY,DENY,DENY,DENY,ALLOW,ALLOW,"permission controller:console"
/api/trips/:id/evaluate-gates,POST,DENY,DENY,DENY,ALLOW,DENY,DENY,ALLOW,ALLOW,"permission compliance:evaluate"
/api/trips/:id/transition-stage,POST,DENY,DENY,ALLOW,ALLOW,DENY,DENY,ALLOW,ALLOW,"permission custody:transition"
/api/trips/:id/generate-evidence-pack,POST,DENY,DENY,DENY,DENY,ALLOW,ALLOW,ALLOW,ALLOW,"permission evidence:generate"
/api/v1/tenants/me,GET,ALLOW,ALLOW,ALLOW,ALLOW,ALLOW,ALLOW,ALLOW,ALLOW,"permission tenant:read; tenant resolved from middleware/header"
/api/v1/appointments,GET,ALLOW,ALLOW,ALLOW,ALLOW,ALLOW,ALLOW,ALLOW,ALLOW,"permission appointments.read + tenant terminal mapping + client/transporter self filters"
/api/v1/appointments,POST,ALLOW,DENY,DENY,DENY,DENY,DENY,ALLOW,ALLOW,"permission appointments.write + tenant terminal mapping + client self enforcement"
/api/v1/webhooks,POST,PUBLIC,PUBLIC,PUBLIC,PUBLIC,PUBLIC,PUBLIC,PUBLIC,PUBLIC,"HMAC signature required; WEBHOOK_SECRET must be configured"
